<script lang="ts">
  import { showHelpDialog } from '$lib/stores';

  function close() {
    showHelpDialog.set(false);
  }
</script>

{#if $showHelpDialog}
  <div class="overlay" onclick={close} role="dialog" aria-modal="true">
    <div class="dialog" onclick={(e) => e.stopPropagation()}>
      <div class="header">
        <h2>A2L Editor æ“ä½œæ‰‹å†Œ</h2>
        <button class="close-btn" onclick={close}>âœ•</button>
      </div>
      
      <div class="content">
        <section>
          <h3>å¿«é€Ÿå¼€å§‹</h3>
          <ol>
            <li><strong>æ‰“å¼€æ–‡ä»¶</strong>: æ–‡ä»¶ â†’ æ‰“å¼€ ELFï¼ˆæˆ–ç›´æ¥æ‰“å¼€æ•°æ®åŒ…ï¼‰</li>
            <li><strong>é€‰æ‹© A2L</strong>: ç‚¹å‡»"é€‰æ‹©ç›®æ ‡ A2L"æŒ‰é’®</li>
            <li><strong>æœç´¢å˜é‡</strong>: åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯</li>
            <li><strong>æ·»åŠ å˜é‡</strong>: å³é”®é€‰ä¸­å˜é‡ â†’ æ·»åŠ ä¸ºè§‚æµ‹å˜é‡/æ ‡å®šå˜é‡</li>
          </ol>
        </section>

        <section>
          <h3>é€‰æ‹©ä¸æ’åº</h3>
          <ul>
            <li><strong>å•é€‰</strong>: å•å‡»å˜é‡è¡Œ</li>
            <li><strong>å¤šé€‰ (Ctrl)</strong>: æŒ‰ä½ Ctrl + å•å‡»</li>
            <li><strong>èŒƒå›´é€‰æ‹© (Shift)</strong>: æŒ‰ä½ Shift + å•å‡»</li>
            <li><strong>å…¨é€‰</strong>: Ctrl + A</li>
            <li><strong>é”®ç›˜å¯¼èˆª</strong>: â†‘â†“ æ–¹å‘é”®</li>
            <li><strong>å•åˆ—æ’åº</strong>: ç‚¹å‡»åˆ—å¤´</li>
            <li><strong>å¤šåˆ—æ’åº</strong>: Shift + ç‚¹å‡»åˆ—å¤´ï¼ˆæ•°å­—è¡¨ç¤ºä¼˜å…ˆçº§ï¼‰</li>
          </ul>
        </section>

        <section>
          <h3>æ·»åŠ å˜é‡</h3>
          <ul>
            <li><strong>ä» ELF æ·»åŠ </strong>: å³é”®é€‰ä¸­å˜é‡ â†’ æ·»åŠ ä¸ºè§‚æµ‹å˜é‡/æ ‡å®šå˜é‡</li>
            <li><strong>æ‰‹åŠ¨æ·»åŠ </strong>: ç‚¹å‡» A2L é¢æ¿æœç´¢æ å³ä¾§ â• æŒ‰é’®ï¼Œè¾“å…¥å˜é‡ä¿¡æ¯</li>
            <li>æ‰‹åŠ¨æ·»åŠ éœ€å¡«å†™ï¼šå˜é‡åã€åœ°å€ï¼ˆåå…­è¿›åˆ¶ï¼‰ã€æ•°æ®ç±»å‹</li>
          </ul>
        </section>

        <section>
          <h3>ç¼–è¾‘ä¸å¤åˆ¶</h3>
          <ul>
            <li><strong>ç¼–è¾‘å˜é‡</strong>: åœ¨ A2L é¢æ¿é€‰ä¸­å•ä¸ªå˜é‡ï¼Œä¸‹æ–¹ç¼–è¾‘åŒºåŸŸä¿®æ”¹å±æ€§</li>
            <li><strong>å¤åˆ¶åç§°</strong>: å³é”®å˜é‡ â†’ å¤åˆ¶åç§°</li>
            <li><strong>å¤åˆ¶åœ°å€</strong>: å³é”®å˜é‡ â†’ å¤åˆ¶åœ°å€</li>
            <li><strong>åˆ é™¤å˜é‡</strong>: å³é”®å˜é‡ â†’ åˆ é™¤å˜é‡</li>
            <li><strong>è°ƒæ•´ç¼–è¾‘åŒºé«˜åº¦</strong>: æ‹–æ‹½ç¼–è¾‘åŒºåŸŸä¸Šæ–¹çš„åˆ†éš”æ¡</li>
            <li><strong>è°ƒæ•´åˆ—å®½</strong>: æ‹–æ‹½åˆ—æ ‡é¢˜ä¹‹é—´çš„åˆ†éš”çº¿</li>
          </ul>
        </section>

        <section>
          <h3>æ•°æ®åŒ…ç³»ç»Ÿ</h3>
          <p>æ¯ä¸ª ELF å¯¹åº”ä¸€ä¸ª <code>.a2ldata</code> æ–‡ä»¶ï¼Œä¸ ELF åŒç›®å½•å­˜æ”¾ã€‚</p>
          <ul>
            <li>é¦–æ¬¡æ‰“å¼€ ELF éœ€è¦ç”Ÿæˆæ•°æ®åŒ…ï¼ˆè§£æçº¦ 160 ç§’ï¼‰</li>
            <li>åç»­åŠ è½½åªéœ€çº¦ 150 æ¯«ç§’</li>
            <li>å¯ç›´æ¥æ‰“å¼€æ•°æ®åŒ…æ–‡ä»¶ï¼Œæ— éœ€ ELF æºæ–‡ä»¶</li>
            <li>å¯é€šè¿‡"é‡æ–°ç”Ÿæˆç¼“å­˜"æ›´æ–°æ•°æ®åŒ…</li>
          </ul>
        </section>

        <section>
          <h3>å˜é‡ç±»å‹è¯´æ˜</h3>
          <ul>
            <li><strong>è§‚æµ‹å˜é‡ (MEASUREMENT)</strong>: åªè¯»ï¼Œç”¨äºç›‘æ§å˜é‡å€¼</li>
            <li><strong>æ ‡å®šå˜é‡ (CHARACTERISTIC)</strong>: å¯å†™ï¼Œç”¨äºæ ‡å®šå‚æ•°</li>
          </ul>
        </section>

        <section>
          <h3>æ”¯æŒçš„ç±»å‹</h3>
          <table>
            <thead>
              <tr><th>DWARF ç±»å‹</th><th>A2L ç±»å‹</th><th>å¤§å°</th></tr>
            </thead>
            <tbody>
              <tr><td>uint8_t, char</td><td>UBYTE</td><td>1</td></tr>
              <tr><td>int8_t</td><td>SBYTE</td><td>1</td></tr>
              <tr><td>uint16_t</td><td>UWORD</td><td>2</td></tr>
              <tr><td>int16_t</td><td>SWORD</td><td>2</td></tr>
              <tr><td>uint32_t</td><td>ULONG</td><td>4</td></tr>
              <tr><td>int32_t</td><td>SLONG</td><td>4</td></tr>
              <tr><td>uint64_t</td><td>A_UINT64</td><td>8</td></tr>
              <tr><td>int64_t</td><td>A_INT64</td><td>8</td></tr>
              <tr><td>float</td><td>FLOAT32_IEEE</td><td>4</td></tr>
              <tr><td>double</td><td>FLOAT64_IEEE</td><td>8</td></tr>
            </tbody>
          </table>
        </section>

        <section>
          <h3>ä¸»é¢˜åˆ‡æ¢</h3>
          <p>ç‚¹å‡»å³ä¸Šè§’ ğŸ¨ æŒ‰é’®åˆ‡æ¢ä¸»é¢˜ï¼šDark / Light / Midnight / Oceanï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰</p>
        </section>

        <section>
          <h3>å­—èŠ‚åºè®¾ç½®</h3>
          <p>ç‚¹å‡» Header å³ä¾§ã€Œå°ç«¯ã€/ã€Œå¤§ç«¯ã€æŒ‰é’®åˆ‡æ¢å­—èŠ‚åº</p>
        </section>
      </div>
    </div>
  </div>
{/if}

<style>
  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
  }

  .dialog {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 12px;
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border);
  }

  .header h2 {
    margin: 0;
    font-size: 18px;
  }

  .close-btn {
    background: none;
    border: none;
    color: var(--text);
    cursor: pointer;
    font-size: 20px;
    padding: 4px 8px;
  }

  .close-btn:hover {
    background: var(--bg-hover);
    border-radius: 4px;
  }

  .content {
    padding: 20px;
    overflow-y: auto;
  }

  section {
    margin-bottom: 20px;
  }

  section:last-child {
    margin-bottom: 0;
  }

  h3 {
    margin: 0 0 10px 0;
    font-size: 15px;
    color: var(--accent);
  }

  ol, ul {
    margin: 0;
    padding-left: 20px;
  }

  li {
    margin-bottom: 6px;
    line-height: 1.5;
  }

  p {
    margin: 0 0 10px 0;
    line-height: 1.5;
  }

  code {
    background: var(--bg-hover);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }

  th, td {
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }

  th {
    background: var(--bg-hover);
    font-weight: 500;
  }
</style>
